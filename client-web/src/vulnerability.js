/*
 * COPYRIGHT 2018 Brightgate Inc.  All rights reserved.
 *
 * This copyright notice is Copyright Management Information under 17 USC 1202
 * and is included to protect this work and deter copyright infringement.
 * Removal or alteration of this Copyright Management Information without the
 * express written permission of Brightgate Inc is prohibited, and any
 * such unauthorized removal or alteration will be a violation of federal law.
 */

// We reviewed the ENISA threat taxonomy (2016) as part of creating this list
// (this list is a small subset, but it's the source of the terminology)
// Archived at https://docs.google.com/spreadsheets/d/1OHzmOB213WQc6r2vDnHbethyOjxCx8m40dbJYaSHTA0/edit#gid=460909398
const threatCategories = [
  // #89: Network Reconnaissance, Network traffic manipulation and Information gathering
  'enisa2016:net_recon',
  // #98: Threat of identity theft
  'enisa2016:identity_theft',
  // #103: Denial of Service (encompasses DDOS)
  'enisa2016:dos',
  // #107: Abuse of Resources (includes CryptoMining)
  'enisa2016:resource_abuse',
  // #110: Worms/Trojans
  'enisa2016:worm',
  // #111: Rootkits
  'enisa2016:rootkit',
  // #112: mobile malware
  'enisa2016:mobile_malware',
  // #116: elevation of privileges
  'enisa2016:priv_elevation',
  // #117: Web application attacks / injection attacks (Code injection: SQL, XSS)
  'enisa2016:webapp_attack',
  // #118: Spyware, Deceptive Adware
  'enisa2016:adware',
  // #119: Viruses
  'enisa2016:virus',
  // #120: Rogue security software/  Rogueware/ Scareware
  'enisa2016:scareware',
  // #121: Ransomware
  'enisa2106:ransomware',
  // #166: Remote Command Execution
  'enisa2106:rce',
];

const vulnerabilities = {
  'defaultpassword': {
    'nickname': 'defaultpassword',
    'headline': 'Vulnerable Password',
    'action_needed': 'immediate',
    'explanation': 'Brightgate\'s scan indicates that this computer exposes a service which has a default or well-known password.  This does not mean that the system is under attack, although this is possible.',
    'threat_categories': ['enisa2016:worm', 'enisa2016:resource_abuse', 'enisa2016:identity_theft', 'enisa2016:net_recon', 'enisa2106:ransomware'],
    'more_info': [
      {
        'source': 'wikipedia.org',
        'url': 'https://en.wikipedia.org/wiki/Default_password',
      },
      {
        'source': 'US CERT',
        'url': 'https://www.us-cert.gov/ncas/alerts/TA13-175A',
      },
    ],
    'remediation': 'Alter the password and record it in a secure password vault.',
  },
  'CVE-2017-0143': {
    'nickname': 'wannacry',
    'headline': 'Vulnerability to Wannacry',
    'action_needed': 'immediate',
    'explanation': 'Brightgate\'s scan indicates that this computer is running software which makes it vulnerable to the Wannacry exploit (CVE-2017-0143).  This does not mean that the system is under attack, although this is possible.',
    'threat_categories': ['enisa2016:ransomware'],
    'more_info': [
      {
        'source': 'wikipedia.org',
        'url': 'https://en.wikipedia.org/wiki/WannaCry_ransomware_attack',
      },
    ],
    'remediation': 'Install <a target="_blank" rel="noopener" class="link external" href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010">Windows patches from Microsoft</a> to close the vulnerability.',
  },
  'CVE-2014-0160': {
    'nickname': 'heartbleed',
    'headline': 'Vulnerability to Heartbleed',
    'action_needed': 'immediate',
    'explanation': 'The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. This weakness allows stealing the information protected, under normal conditions, by the SSL/TLS encryption used to secure the Internet.',
    'threat_categories': ['enisa2016:priv_elevation', 'enisa2016:identity_theft', 'enisa2016:net_recon'],
    'more_info': [
      {
        'source': 'heartbleed.com',
        'url': 'http://heartbleed.com',
      },
    ],
    'remediation': 'Install patches to the affected systems.',
  },
  'CVE-2018-6789': {
    'headline': 'Outdated, Vulnerable Exim Software',
    'action_needed': 'immediate',
    'explanation': 'A security bug was discovered in the Exim SMTP (Email) listener in versions below 4.90.1.',
    'threat_categories': ['enisa2016:worm', 'enisa2016:rootkit'],
    'more_info': [],
    'remediation': 'Install patches to the affected systems.',
  },
  'CVE-2019-10149': {
    'headline': 'Outdated, Vulnerable Exim Software',
    'action_needed': 'immediate',
    'explanation': 'A security bug was discovered in the Exim SMTP (Email) listener in versions from 4.87 to 4.91 inclusive.',
    'threat_categories': ['enisa2016:rce'],
    'more_info': [],
    'remediation': 'Install patches to the affected systems.',
  },
};

function headline(vulnid) {
  if (vulnerabilities[vulnid] === undefined ||
      vulnerabilities[vulnid].headline === undefined) {
    return `Vulnerability ${vulnid}`;
  }
  return vulnerabilities[vulnid].headline;
}

function explanation(vulnid) {
  if (vulnerabilities[vulnid] === undefined ||
      vulnerabilities[vulnid].explanation === undefined) {
    return '';
  }
  return vulnerabilities[vulnid].explanation;
}

function remediation(vulnid) {
  if (vulnerabilities[vulnid] === undefined ||
      vulnerabilities[vulnid].remediation === undefined) {
    return '';
  }
  return vulnerabilities[vulnid].remediation;
}

function moreInfo(vulnid) {
  if (vulnerabilities[vulnid] === undefined ||
      vulnerabilities[vulnid].more_info === undefined) {
    return [];
  }
  return vulnerabilities[vulnid].more_info;
}

export default {
  threatCategories,
  headline,
  explanation,
  remediation,
  moreInfo,
};
